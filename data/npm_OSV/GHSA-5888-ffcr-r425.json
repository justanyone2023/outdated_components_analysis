{
  "id": "GHSA-5888-ffcr-r425",
  "summary": "Prototype Pollution leading to Remote Code Execution in superjson",
  "details": "### Impact\n\nThis is critical vulnerability, as it allows to run arbitrary code on any server using superjson input, including a Blitz.js server, without prior authentication or knowledge. Attackers gain full control over the server so they could steal and manipulate data or attack further systems. The only requirement is that the server implements at least one endpoint which uses superjson during request processing. In the case of Blitz.js, it would be at least one RPC call. \n\n### Patches\nThis has been patched in superjson 1.8.1 and Blitz.js 0.45.3. \n\nIf you are unable to upgrade to Blitz.js 0.45.3 in a timely manner, you can instead upgrade only superjson to version 1.8.1 using yarn resolutions are similar. Blitz versions < 0.45.3 are only affected because they used superjson versions < 1.8.1.\n\n### Workarounds\nNone\n\n### For more information\nIf you have any questions or comments about this advisory:\n* Open an issue in https://github.com/blitz-js/superjson\n* Email us at b@bayer.ws\n",
  "aliases": [
    "CVE-2022-23631"
  ],
  "modified": "2022-02-09T22:20:49Z",
  "published": "2022-02-09T22:20:49Z",
  "database_specific": {
    "nvd_published_at": "2022-02-09T22:15:00Z",
    "github_reviewed_at": "2022-02-09T22:20:49Z",
    "severity": "CRITICAL",
    "github_reviewed": true,
    "cwe_ids": [
      "CWE-1321",
      "CWE-94"
    ]
  },
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/blitz-js/superjson/security/advisories/GHSA-5888-ffcr-r425"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-23631"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/blitz-js/superjson"
    },
    {
      "type": "WEB",
      "url": "https://www.sonarsource.com/blog/blitzjs-prototype-pollution/"
    }
  ],
  "affected": [
    {
      "package": {
        "name": "superjson",
        "ecosystem": "npm",
        "purl": "pkg:npm/superjson"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.8.1"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-5888-ffcr-r425/GHSA-5888-ffcr-r425.json"
      }
    },
    {
      "package": {
        "name": "blitz",
        "ecosystem": "npm",
        "purl": "pkg:npm/blitz"
      },
      "ranges": [
        {
          "type": "SEMVER",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "0.45.3"
            }
          ]
        }
      ],
      "database_specific": {
        "source": "https://github.com/github/advisory-database/blob/main/advisories/github-reviewed/2022/02/GHSA-5888-ffcr-r425/GHSA-5888-ffcr-r425.json"
      }
    }
  ],
  "schema_version": "1.6.0",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H"
    }
  ]
}